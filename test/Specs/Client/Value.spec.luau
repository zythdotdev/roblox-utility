return function()
	local ReplicatedStorage = game:GetService("ReplicatedStorage")
	local Value = require(ReplicatedStorage.Modules.Value)

	describe("Value", function()
		it("should create a new value with initial value", function()
			local value = Value.new(1)
			expect(value).to.be.ok()
			expect(value.className).to.equal("Value")
			expect(value:Get()).to.equal(1)
		end)
		it("should create a new value with no initial value", function()
			local value = Value.new()
			expect(value).to.be.ok()
			expect(value.className).to.equal("Value")
			expect(value:Get()).to.equal(nil)
		end)
		it("should set the value", function()
			local value = Value.new(1)
			value:Set(2)
			expect(value:Get()).to.equal(2)
		end)
		it("should set the value to nil", function()
			local value = Value.new(1)
			value:Set(nil)
			expect(value:Get()).to.equal(nil)
		end)
		it("should set the value to a table", function()
			local value = Value.new(1)
			local tbl = { a = 1, b = 2 }
			value:Set(tbl)
			expect(value:Get()).to.equal(tbl)
		end)
		it("should not fire event when setting to same value", function()
			local value = Value.new(1)
			local fireCount = 0
			value:Observe(function()
				fireCount += 1
			end)
			fireCount = 0
			value:Set(1)
			expect(fireCount).to.equal(0)
		end)
		it("should fire event when setting to different value", function()
			local value = Value.new(1)
			local fireCount = 0
			value:Observe(function()
				fireCount += 1
			end)
			fireCount = 0
			value:Set(2)
			expect(fireCount).to.equal(1)
		end)
		it("should observe the value and fire immediately", function()
			local value = Value.new(1)
			local observed = nil
			value:Observe(function(newValue)
				observed = newValue
			end)
			expect(observed).to.equal(1)
		end)
		it("should observe value changes", function()
			local value = Value.new(1)
			local observed = nil
			value:Observe(function(newValue)
				observed = newValue
			end)
			value:Set(2)
			expect(observed).to.equal(2)
		end)
		it("should disconnect the observer", function()
			local value = Value.new(1)
			local observed = 1
			local connection = value:Observe(function(newValue)
				observed = newValue
			end)
			connection:Disconnect()
			value:Set(2)
			expect(observed).to.equal(1)
		end)
		it("should handle Setter function", function()
			local value = Value.new(1)
			local setter = value:Setter()
			setter(2)
			expect(value:Get()).to.equal(2)
		end)
		it("should destroy the value", function()
			local value = Value.new(1)
			value:Destroy()
			expect(value._Event).to.equal(nil)
			expect(value._Value).to.equal(nil)
		end)
		it("should throw error when accessing destroyed value", function()
			local value = Value.new(1)
			value:Destroy()
			expect(function()
				value:Get()
			end).to.throw()
		end)
		it("should throw error when setting destroyed value", function()
			local value = Value.new(1)
			value:Destroy()
			expect(function()
				value:Set(2)
			end).to.throw()
		end)
		it("should throw error when observing destroyed value", function()
			local value = Value.new(1)
			value:Destroy()
			expect(function()
				value:Observe(function() end)
			end).to.throw()
		end)
		it("should handle multiple observers", function()
			local value = Value.new(1)
			local observed1, observed2 = nil, nil
			value:Observe(function(newValue)
				observed1 = newValue
			end)
			value:Observe(function(newValue)
				observed2 = newValue
			end)
			value:Set(2)
			expect(observed1).to.equal(2)
			expect(observed2).to.equal(2)
		end)
	end)
end